<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <title>OrganiZ - Pastas</title>
    <link rel="stylesheet" href="pastas.css" />
</head>

<body>

    <div class="header">
        <h1 onclick="window.location.href='index.html'">OrganiZ</h1>
        <img src="images/usuÃ¡rio.png" alt="login" />
    </div>

    <h1>Pastas Salvas</h1>
    <div id="lista-pastas"></div>

    <button class="voltar" onclick="window.location.href='index.html'">Voltar</button>
    <button class="novapasta" onclick="window.location.href='criar.html'">Criar nova pasta</button>

    <script>
        const lista = document.getElementById('lista-pastas');

        async function obterPastas() {
            const resposta = await fetch('http://localhost:3000/pastas');
            return resposta.json();
        }

        async function excluirPasta(id) {
            await fetch(`http://localhost:3000/pastas/${id}`, {
                method: 'DELETE'
            });
        }

        async function renderizarPastas() {
            const pastas = await obterPastas();
            lista.innerHTML = '';

            if (pastas.length === 0) {
                lista.innerHTML = "<p class='mensagemvazia'>Nenhuma pasta criada ainda.</p>";
                return;
            }

            pastas.forEach(pasta => {
                const div = document.createElement('div');
                div.className = 'pasta';
                div.innerHTML = `
        <div><span class="cor" style="background-color:${pasta.cor}"></span> <strong>${pasta.nome}</strong></div>
        <p>${pasta.descricao}</p>
        <div class="botoes">
          <button class="acessar">Acessar</button>
          <button class="editar">Editar</button>
          <button class="excluir">Excluir</button>
        </div>
      `;

                div.querySelector('.acessar').addEventListener('click', () => {
                    window.location.href = `detalhes.html?id=${pasta.id}`;
                });

                div.querySelector('.editar').addEventListener('click', () => {
                    window.location.href = `criar.html?id=${pasta.id}`;
                });

                div.querySelector('.excluir').addEventListener('click', async () => {
                    if (confirm('Tem certeza que deseja excluir esta pasta?')) {
                        await excluirPasta(pasta.id);
                        renderizarPastas();
                    }
                });

                lista.appendChild(div);
            });
        }

        renderizarPastas();
    </script>

</body>

</html>